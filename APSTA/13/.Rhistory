setwd("W:/Projects/ITU/APSTA/13")
var_x <- 41258741
var_y <- 50744521
n <- 72
m <- n
v <- ( ( (var_x/n) + (var_y/m) )^2 ) / ( ( (var_x^2)/((n^2) * (n-1)) ) + ( (var_y^2/((m^2) * (m-1)) ) ) )
cat("Degrees of freedom:", v)
var_x <- 41258741
var_y <- 50744521
n <- 72
m <- n
v <- ( ( (var_x/n) + (var_y/m) )^2 ) / ( ( (var_x^2)/((n^2) * (n-1)) ) + ( (var_y^2/((m^2) * (m-1)) ) ) )
cat("Degrees of freedom:", v)
qt(1-0.05/2, v)
qt(1-0.05/2, v)
(17410-19818) / sqrt((41258741/72)+(50744521/72))
dads <- babies$age
library(UsingR)
library(UsingR)
moms <- babies$age
x_var <- var(moms)
moms <- babies$age # X
dads <- babies$dage # Y
x_bar <- mean(moms)
y_bar <- mean(dads)
x_var <- var(moms)
y_var <- var(dads)
n <- length(moms)
m <- length(dads)
moms <- babies$age # X
dads <- babies$dage # Y
x_bar <- mean(moms)
y_bar <- mean(dads)
x_var <- var(moms)
y_var <- var(dads)
n <- length(moms)
m <- length(dads)
t_d_s_samples <- c()
for (i in 1:10000) {
bootstrapped_moms <- sample(moms, n, replace=TRUE)
bootstrapped_dads <- sample(dads, m, replace=TRUE)
x_bar_s <- means(bootstrapped_moms)
y_bar_s <- means(bootstrapped_dads)
x_sd_s <- sd(bootstrapped_moms)
y_sd_s <- sd(bootstrapped_dads)
s_d_s_sq <- ((x_sd_s^2) / n) + ((y_sd_s^2) / m)
t_d_s <- ( (x_bar_s - y_bar_s) - (x_bar - y_bar) ) / sqrt(s_d_s_sq)
}
moms <- babies$age # X
dads <- babies$dage # Y
x_bar <- mean(moms)
y_bar <- mean(dads)
x_var <- var(moms)
y_var <- var(dads)
n <- length(moms)
m <- length(dads)
t_d_s_samples <- c()
for (i in 1:10000) {
bootstrapped_moms <- sample(moms, n, replace=TRUE)
bootstrapped_dads <- sample(dads, m, replace=TRUE)
x_bar_s <- mean(bootstrapped_moms)
y_bar_s <- mean(bootstrapped_dads)
x_sd_s <- sd(bootstrapped_moms)
y_sd_s <- sd(bootstrapped_dads)
s_d_s_sq <- ((x_sd_s^2) / n) + ((y_sd_s^2) / m)
t_d_s <- ( (x_bar_s - y_bar_s) - (x_bar - y_bar) ) / sqrt(s_d_s_sq)
}
c_l_s <- quantile(t_d_s_samples, 0.05)
moms <- babies$age # X
dads <- babies$dage # Y
x_bar <- mean(moms)
y_bar <- mean(dads)
x_var <- var(moms)
y_var <- var(dads)
n <- length(moms)
m <- length(dads)
t_d_s_samples <- c()
for (i in 1:10000) {
bootstrapped_moms <- sample(moms, n, replace=TRUE)
bootstrapped_dads <- sample(dads, m, replace=TRUE)
x_bar_s <- mean(bootstrapped_moms)
y_bar_s <- mean(bootstrapped_dads)
x_sd_s <- sd(bootstrapped_moms)
y_sd_s <- sd(bootstrapped_dads)
s_d_s_sq <- ((x_sd_s^2) / n) + ((y_sd_s^2) / m)
t_d_s <- ( (x_bar_s - y_bar_s) - (x_bar - y_bar) ) / sqrt(s_d_s_sq)
}
c_l_s <- quantile(t_d_s_samples, 0.05)
c_l_s
moms <- babies$age # X
dads <- babies$dage # Y
x_bar <- mean(moms)
y_bar <- mean(dads)
x_var <- var(moms)
y_var <- var(dads)
n <- length(moms)
m <- length(dads)
t_d_s_samples <- c()
for (i in 1:10000) {
bootstrapped_moms <- sample(moms, n, replace=TRUE)
bootstrapped_dads <- sample(dads, m, replace=TRUE)
x_bar_s <- mean(bootstrapped_moms)
y_bar_s <- mean(bootstrapped_dads)
x_sd_s <- sd(bootstrapped_moms)
y_sd_s <- sd(bootstrapped_dads)
s_d_s_sq <- ((x_sd_s^2) / n) + ((y_sd_s^2) / m)
t_d_s <- ( (x_bar_s - y_bar_s) - (x_bar - y_bar) ) / sqrt(s_d_s_sq)
t_d_s_samples <- c(t_d_s_samples, t_d_s)
}
c_l_s <- quantile(t_d_s_samples, 0.05)
c_l_s
c_l_s <- quantile(t_d_s_samples, 0.05)
c_l_s <- quantile(t_d_s_samples, 0.05)
c_l_s <- quantile(t_d_s_samples, 0.05)
c_l_s <- quantile(t_d_s_samples, 0.05)
cat("Critical value:", c_l_s)
t_d <- (x_bar - y_bar) / sqrt( (x_var/n) + (y_var/m) )
cat("Realised test statistic:",t_d)
t_d <- (x_bar - y_bar) / sqrt( (x_var/n) + (y_var/m) )
cat("Realised test statistic:",t_d)
